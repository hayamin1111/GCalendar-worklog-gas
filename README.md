# GCalendar-worklog-gas
Googleカレンダーから工数算出するGAS

Googleカレンダーの予定を解析し、
**工数データをスプレッドシートに出力 & ピボットテーブルで集計**します。

予定のタイトルを一定のルールで書くだけで、

- 物件別
- クライアント別
- 作業内容別
- 担当者別
- 合計工数（時間）

を自動で集計できます。


## できること

- Googleカレンダーの予定を指定期間で取得
- タイトル文字列を構造化データに変換
- 作業時間を分・時間で集計
- スプレッドシートに一覧を書き出し
- **宣言的に定義したピボットテーブルを自動生成**


## 想定ユースケース

- 個人・小規模チームの工数管理
- 案件別の作業時間の可視化
- 日報・月報の元データ作成
- 「とりあえずカレンダーに全部書いてる」を卒業したい人


## カレンダータイトルの書式

予定タイトルは以下の形式を想定しています。

【案件名 | クライアント名】作業内容 / 担当者

### 例

`【hogeモックアップ | ABC社】原型製作`

`【hogeモックアップ | ABC社】原型製作 / B`

`【huga文字オブジェ | XYZ社】図面作成 / M・S`

`【piyo立体造形 | SSS社】図面作成 / E, M, S`

- 担当者は省略可能（省略時はデフォルト担当者を使用）
- 複数担当者は `・` または `,` 区切り


## 出力されるシート構成

| 列名 | 内容 |
|---|---|
| 案件名 | 案件名 |
| クライアント名 | クライアント |
| 作業内容 | タスク |
| 担当者 | 担当者名 |
| 所要時間（分） | 分単位 |
| 所要時間（時間） | 時間単位 |
| カラー | カレンダーイベントの色 |

最終行に合計時間も自動で追加されます。


## ピボットテーブル（宣言的定義）

ピボットテーブルは **コードを書き換えずに定義オブジェクトだけで変更**できます。

```js
const PIVOT_DEFINITION = {
  rows:    ["物件名"],
  columns: ["担当者"],
  values: [
    { column: "所要時間（時間）", summarize: "SUM", displayName: "合計時間" }
  ],
};
``` 

## 注意点

- 自分のGoogleカレンダーを前提としています。
- 大量の予定がある場合、実行時間制限に注意してください
- タイトル形式が崩れるとスキップされます（ログに出力）
